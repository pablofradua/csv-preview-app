<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsf="http://xmlns.jcp.org/jsf">

<h:head>
    <title>Data Table Test</title>

    <h:outputStylesheet library="vendor" name="primeflex/primeflex.min.css"/>
    <h:outputStylesheet library="css" name="styles.css"/>
</h:head>

<h:body>
    <div class="p-grid p-align-stretch vertical-container content">
        <h:form id="table-form" styleClass="full-height" enctype="multipart/form-data">
	        <div class="p-col-fixed full-height">
	            <div class="full-height sidebar">
	                <p:card id="control-card">
	                    <f:facet name="title">
	                        File
	                    </f:facet>
	                    <div class="ui-fluid">
	                        <div class="p-field">
	                            <label for="@next">Step 1: Upload a file</label>
	                            <p:fileUpload accept="text/csv" allowTypes="/(\.|\/)(csv)$/" label="Select file" listener="#{fileUploadListener.handleFileUpload}"
	                            update="results-section"/>
	                        </div>
	                        <div class="p-field">
	                            <label for="@next">Column Separator</label>
	                            <p:selectOneMenu id="column-separator">
	                                <f:selectItem itemLabel="Comma" itemValue="comma"/>
	                                <f:selectItem itemLabel="Semicolon" itemValue="semicolon"/>
	                                <f:selectItem itemLabel="Tabstop" itemValue="tabstop"/>
	                            </p:selectOneMenu>
	                        </div>
	                    </div>
	                </p:card>
	            </div>
	        </div>
	        <div jsf:id="results-section" class="p-col full-height">
	            	<h:outputFormat value="Displaying file: {0}" rendered="#{fileDataPanel.fileLoaded}">
	            		<f:param value="#{fileDataPanel.csvFile.filename}"/>
	            	</h:outputFormat>
	            	<h:outputText value="No file selected" rendered="#{fileDataPanel.noFileLoaded}"/>
	                <p:dataTable id="table"
	                             var="fileRow"
	                             value="#{fileDataPanel.csvFile.rows}"
	                             scrollable="true"
	                             scrollHeight="100%"
	                             styleClass="csv-preview-table"
	                             rendered="#{fileDataPanel.fileLoaded}">
						<p:columns value="#{fileDataPanel.csvFile.columnNames}"  var="columnName" columnIndexVar="colIndex">  
						  <f:facet name="header">#{columnName}</f:facet>
						  <h:outputText value="#{fileRow[colIndex]}" />
						</p:columns>
	                </p:dataTable>
	        </div>
        </h:form>
    </div>
</h:body>
</html>